<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>The Sommerville Masters Golf Pool Invitational</title>
<!-- External CSS -->
<link rel="stylesheet" href="styles/style.css" />
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet" />

<style>
/* Your existing styles here... (keep your styles from previous code) */

body {
    font-family: 'Roboto', sans-serif;
    background-color: #f5f5f5;
    color: #1a4831;
    text-align: center;
    margin: 0;
    padding: 0;
}
/* ... (rest of your CSS styles) ... */

header {
    background: #1a4831;
    color: #ffffff;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    position: relative;
}
/* ... other styles ... */

#logo {
    max-height: 60px;
    cursor: pointer;
}
/* ... rest of your styles ... */

</style>
</head>
<body>

<header>
    <a href="index.html">
        <img id="logo" src="https://brandlogos.net/wp-content/uploads/2025/04/masters_tournament_icon-logo_brandlogos.net_xjp0a.png" alt="Logo" />
    </a>
    <nav>
        <div class="logo-container" onclick="toggleDropdown()">
            <img src="https://flowervectors.com/wp-content/uploads/beautiful-azalea-flower-transparent.png" alt="Azalea Logo" />
            <span class="menu-text">Menu</span>
        </div>
        <div id="dropdown" class="dropdown" style="display:none;">
            <a href="index.html">Home</a>
            <a href="register.html">Register</a>
            <a href="leaderboard.html">Pick 'Em Leaderboard</a>
            <a href="scores.html">Masters Leaderboard</a>
            <a href="faq.html">FAQ</a>
            <a href="past-results.html">Past Results</a>
        </div>
    </nav>
</header>

<main>
<!-- Existing main content like slideshow, leaderboard, etc. -->

<!-- Authentication UI -->
<div id="auth-container" style="text-align:center; margin:20px;">
  <div id="user-info">Not logged in.</div>
  <div id="auth-forms" style="margin-top:10px;">
    <div style="margin-bottom:10px;">
      <input type="email" id="signup-email" placeholder="Email" />
      <input type="password" id="signup-password" placeholder="Password" />
      <button id="signup-btn">Sign Up</button>
    </div>
    <div style="margin-bottom:10px;">
      <input type="email" id="signin-email" placeholder="Email" />
      <input type="password" id="signin-password" placeholder="Password" />
      <button id="signin-btn">Sign In</button>
    </div>
    <button id="signout-btn" style="display:none;">Sign Out</button>
  </div>
</div>

<!-- Chat Box -->
<div id="chat-container" style="border: 1px solid #ccc; width: 350px; height: 400px; overflow-y: auto; margin: 20px auto; padding: 10px; background: #fff;">
  <h3 style="text-align:center;">Chat</h3>
  <div id="messages" style="margin-bottom:10px; height:300px; overflow-y:auto; border:1px solid #ddd; padding:5px; background:#f9f9f9;"></div>
  <input type="text" id="message-input" placeholder="Type a message" style="width:70%; padding:8px; margin-right:5px;" />
  <button id="send-btn" style="padding:8px 12px;">Send</button>
</div>

<!-- Existing footer or other content below -->

</main>

<!-- Scripts at end of body -->
<!-- Existing scripts like dropdown toggle, slideshow, etc. -->

<script>
  // Toggle dropdown menu
function toggleDropdown() {
  const dropdown = document.getElementById('dropdown');
  dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
}

// Close dropdown when clicking outside
window.onclick = function(event) {
  if (!event.target.closest('.logo-container')) {
    const dropdown = document.getElementById('dropdown');
    if (dropdown.style.display === 'block') {
      dropdown.style.display = 'none';
    }
  }
}

// Slideshow code (keep your existing)
let slideIndex = 0;
showSlides();

function showSlides() {
  let slides = document.getElementsByClassName("mySlides");
  for (let i=0; i<slides.length; i++) {
    slides[i].style.display='none';
  }
  slideIndex++;
  if (slideIndex > slides.length) { slideIndex=1; }
  slides[slideIndex-1].style.display='block';
  setTimeout(showSlides,5000);
}
</script>

<!-- Load Supabase SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/supabase.min.js"></script>

<script>
  // Initialize Supabase
const supabaseUrl = 'https://mgmpzllkceyemdvptpzj.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1nbXB6bGxrY2V5ZW1kdnB0cHpqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NzA1MzYsImV4cCI6MjA2NDU0NjUzNn0.a8rjF4PX76YeFNC6GDWf3WFXhjOHYsUN0xOIa3c02XQ';

const supabase = supabase.createClient(supabaseUrl, supabaseKey);

const userInfoDiv = document.getElementById('user-info');
const messagesDiv = document.getElementById('messages');
const messageInput = document.getElementById('message-input');

// Sign Up
document.getElementById('signup-btn').onclick = async () => {
  const email = document.getElementById('signup-email').value;
  const password = document.getElementById('signup-password').value;
  const { user, error } = await supabase.auth.signUp({ email, password });
  if (error) alert(error.message);
  else alert('Check your email to confirm your account.');
};

// Sign In
document.getElementById('signin-btn').onclick = async () => {
  const email = document.getElementById('signin-email').value;
  const password = document.getElementById('signin-password').value;
  const { user, error } = await supabase.auth.signIn({ email, password });
  if (error) alert(error.message);
};

// Sign Out
document.getElementById('signout-btn').onclick = async () => {
  await supabase.auth.signOut();
};

// Update UI on auth change
supabase.auth.onAuthStateChange((event, session) => {
  updateUI(session?.user);
  loadMessages();
});

function updateUI(user) {
  if (user) {
    document.getElementById('user-info').innerText = `Logged in as: ${user.email}`;
    document.getElementById('signout-btn').style.display='inline-block';
  } else {
    document.getElementById('user-info').innerText='Not logged in.';
    document.getElementById('signout-btn').style.display='none';
    messagesDiv.innerHTML='<em>Please log in to see messages.</em>';
  }
}

// Load messages
async function loadMessages() {
  const user = supabase.auth.user();
  if (!user) {
    messagesDiv.innerHTML='<em>Please log in to see messages.</em>';
    return;
  }
  const { data, error } = await supabase
    .from('messages')
    .select('*')
    .order('created_at', { ascending: true });
  if (error) { console.error('Error loading messages:', error); return; }
  messagesDiv.innerHTML='';
  data.forEach(msg => {
    const msgElem=document.createElement('div');
    msgElem.style.marginBottom='8px';
    msgElem.innerHTML=`<strong>${msg.user_name || 'Anonymous'}:</strong> ${msg.content}`;
    messagesDiv.appendChild(msgElem);
  });
  messagesDiv.scrollTop=messagesDiv.scrollHeight;
}

// Subscribe to new messages
supabase
  .from('messages')
  .on('INSERT', payload => { loadMessages(); })
  .subscribe();

// Send message
document.getElementById('send-btn').onclick=async () => {
  const user = supabase.auth.user();
  if (!user) { alert('Please log in to send messages.'); return; }
  const content = messageInput.value.trim();
  if (!content) return;
  const { error }=await supabase
    .from('messages')
    .insert([{ content, user_name: user.email }]);
  if (error) console.error('Error sending message:', error);
  messageInput.value='';
};

// Check auth state on page load
window.onload=()=> {
  const user=supabase.auth.user();
  updateUI(user);
  loadMessages();
};
</script>

</body>
</html>
